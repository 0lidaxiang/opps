tinymce.PluginManager.add('oppsembed', function(editor, url) {
    plugin_on_click = function() {
        editor.windowManager.open({
            title: 'Inserir conteúdo embed',
            body: [{
                type: 'label',
                name: 'label',
                label: 'Insira o código de incorporação abaixo:',
            }, {
                type: 'textbox',
                name: 'code',
                multiline: true,
                minHeight: 200
            }],
            onsubmit: function(e) {
                if (e.data.code) {
                    editor.insertContent(e.data.code);
                }
            }
        });
    }

    editor.addButton('oppsembed', {
        text: false,
        icon: "code",
        tooltip: 'Inserir conteúdo embed',
        onclick: plugin_on_click
    });

    editor.addMenuItem('oppsembed', {
        text: 'Inserir conteúdo embed',
        icon: false,
        context: 'insert',
        onclick: plugin_on_click
    });
});